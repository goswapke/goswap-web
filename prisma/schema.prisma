generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role { TRAVELER PARTNER ADMIN }
enum VehicleStatus { PENDING_APPROVAL AVAILABLE BOOKED ARCHIVED }
enum Category { LEASE SWAP }
enum PickupType { SGR AIRPORT CITY_CENTER }
enum DriveMode { SELF_DRIVE CHAUFFEURED }
enum PaymentKind { LEASE SWAP_FEE }
enum PaymentStatus { PENDING PAID FAILED }

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String
  phone     String?
  role      Role     @default(TRAVELER)
  isAdmin   Boolean  @default(false)
  createdAt DateTime @default(now())
  vehicles  Vehicle[]
  bookings  Booking[]
}

model Vehicle {
  id                String         @id @default(cuid())
  ownerId           String
  owner             User           @relation(fields: [ownerId], references: [id])
  make              String
  model             String
  year              Int
  fuelType          String
  type              String
  plate             String
  primaryCity       String
  preferredSwapCity String?
  category          Category       @default(LEASE)
  status            VehicleStatus  @default(PENDING_APPROVAL)
  photos            String[]
  priceSelf         Int
  priceChauffeured  Int
  createdAt         DateTime       @default(now())
  bookings          Booking[]
}

model Booking {
  id         String     @id @default(cuid())
  vehicleId  String
  vehicle    Vehicle    @relation(fields: [vehicleId], references: [id])
  travelerId String
  traveler   User       @relation(fields: [travelerId], references: [id])
  startDate  DateTime
  endDate    DateTime
  pickupType PickupType
  driveMode  DriveMode
  arrivalAt  DateTime
  total      Int
  status     String     @default("PENDING")
  paymentId  String?
  payment    Payment?   @relation(fields: [paymentId], references: [id])
  createdAt  DateTime   @default(now())
}

model Payment {
  id        String        @id @default(cuid())
  kind      PaymentKind
  status    PaymentStatus @default(PENDING)
  amount    Int
  currency  String        @default("KES")
  meta      Json?
  createdAt DateTime      @default(now())
}
